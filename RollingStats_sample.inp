set verbose off
include RollingStats.gfn --force

open denmark.gdt -q

scalar wsize = 22	# window lenght

# Skewness
matrix mSK = rolling_ts(LRM, "skewness", wsize)
series SK = rvec2series(LRM, mSK, wsize)
print SK -o

# Minimum -- "one-liner"
series MIN = rvec2series(LRM, rolling_ts(LRM, "min", wsize), wsize)
print MIN -o


# Call your own user-defined function
#-------------------------------------
# AR(1)-coefficient over time (w.o. intercept in the regression)
function scalar my_AR1 (const series y)
    ols y const y(-1) --quiet
    return $coeff[2]	# return AR(1) coeff.
end function 
# Call
matrix mbhat = rolling_ts(LRM, "my_AR1", wsize, 0)
series bhat = rvec2series(LRM, mbhat, wsize)
gnuplot bhat --with-lines --time-series --output=display
